{"version":3,"sources":["Api.js"],"names":["async","url","method","requestBody","requestOptions","returnEntireResponse","clientId","await","Session","clientIdAsync","user","UserManager","getCurrentUserAsync","sessionSecret","skipValidationToken","process","env","let","headers","options","data","formData","isNode","convertedFormData","_convertFormDataToBuffer","getHeaders","response","axios","request","Error","responseBody","responseObj","_","isString","JSON","parse","e","ErrorCode","INVALID_JSON","err","ApiError","code","serverError","_callMethodAsync","Promise","resolve","pipe","concat","encoding","outputPath","progressFunction","retryFunction","promptShown","currentProgress","cancel","token","CancelToken","source","warningTimer","setTimeout","TIMER_DURATION","config","timeout","TIMEOUT","responseType","cancelToken","onDownloadProgress","progressEvent","roundedProgress","Math","floor","loaded","total","clearTimeout","fs","writeFile","Buffer","from","tmpPath","totalDownloadSize","downloadProgress","on","chunk","length","createWriteStream","rename","_downloadAsync","followRedirects","maxBodyLength","message","_isApiError","ROOT_BASE_URL","Config","api","scheme","host","port","API_BASE_URL","ApiClient","static","callMethodAsync","methodName","args","encodeURIComponent","stringify","callPathAsync","path","versionsAsync","_versionCache","getAsync","xdlSchemaAsync","sdkVersion","_schemaCaches","hasOwnProperty","join","__dirname","sdkVersionsAsync","sdkVersions","turtleSdkVersionsAsync","turtleSdkVersions","downloadAsync","extract","dotExpoHomeDirectory","UserSettings","Extract","extractAsync","rimraf","sync"],"mappings":"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","file":"../Api.js","sourcesContent":["/**\n * @flow\n */\n\nimport _ from 'lodash';\nimport fs from 'fs-extra';\nimport rimraf from 'rimraf';\nimport path from 'path';\nimport axios from 'axios';\nimport followRedirects from 'follow-redirects';\nimport concat from 'concat-stream';\n\nimport { Cacher } from './tools/FsCache';\nimport Config from './Config';\nimport { isNode } from './tools/EnvironmentHelper';\nimport ErrorCode from './ErrorCode';\nimport * as Extract from './Extract';\nimport * as Session from './Session';\nimport UserManager from './User';\nimport UserSettings from './UserSettings';\nimport XDLError from './XDLError';\n\nfollowRedirects.maxBodyLength = 50 * 1024 * 1024; // 50 MB\n\nconst TIMER_DURATION = 30000;\nconst TIMEOUT = 3600000;\n\nfunction ApiError(code, message) {\n  let err = new Error(message);\n  // $FlowFixMe error has no property code\n  err.code = code;\n  // $FlowFixMe error has no property _isApiError\n  err._isApiError = true;\n  return err;\n}\n\nlet ROOT_BASE_URL = `${Config.api.scheme}://${Config.api.host}`;\nif (Config.api.port) {\n  ROOT_BASE_URL += ':' + Config.api.port;\n}\nlet API_BASE_URL = ROOT_BASE_URL + '/--/api/';\n\nasync function _callMethodAsync(\n  url,\n  method,\n  requestBody,\n  requestOptions,\n  returnEntireResponse = false\n): Promise<any> {\n  const clientId = await Session.clientIdAsync();\n  const user = (await UserManager.getCurrentUserAsync()) || {};\n\n  const { sessionSecret } = user;\n  const skipValidationToken = process.env['EXPO_SKIP_MANIFEST_VALIDATION_TOKEN'];\n\n  let headers: any = {\n    'Exp-ClientId': clientId,\n  };\n\n  if (skipValidationToken) {\n    headers['Exp-Skip-Manifest-Validation-Token'] = skipValidationToken;\n  }\n\n  if (sessionSecret) {\n    headers['Expo-Session'] = sessionSecret;\n  }\n\n  let options = {\n    url,\n    method: method || 'get',\n    headers,\n  };\n\n  if (requestBody) {\n    options = {\n      ...options,\n      data: requestBody,\n    };\n  }\n\n  if (requestOptions) {\n    if (requestOptions.formData) {\n      let data = requestOptions.formData;\n      if (isNode()) {\n        let convertedFormData = await _convertFormDataToBuffer(requestOptions.formData);\n        data = convertedFormData.data;\n        options.headers = {\n          ...options.headers,\n          ...requestOptions.formData.getHeaders(),\n        };\n      }\n      options = { ...options, data };\n    } else {\n      options = { ...options, ...requestOptions };\n    }\n  }\n  let response = await axios.request(options);\n  if (!response) {\n    throw new Error('Unexpected error: Request failed.');\n  }\n  let responseBody = response.data;\n  var responseObj;\n  if (_.isString(responseBody)) {\n    try {\n      responseObj = JSON.parse(responseBody);\n    } catch (e) {\n      throw new XDLError(\n        ErrorCode.INVALID_JSON,\n        'Invalid JSON returned from API: ' + e + '. Response body: ' + responseBody\n      );\n    }\n  } else {\n    responseObj = responseBody;\n  }\n  if (responseObj.err) {\n    let err = ApiError(responseObj.code || 'API_ERROR', 'API Response Error: ' + responseObj.err);\n    // $FlowFixMe can't add arbitrary properties to error\n    err.serverError = responseObj.err;\n    throw err;\n  } else {\n    return returnEntireResponse ? response : responseObj;\n  }\n}\n\nasync function _convertFormDataToBuffer(formData) {\n  return new Promise(resolve => {\n    formData.pipe(concat({ encoding: 'buffer' }, data => resolve({ data })));\n  });\n}\n\nasync function _downloadAsync(url, outputPath, progressFunction, retryFunction) {\n  let promptShown = false;\n  let currentProgress = 0;\n\n  let { cancel, token } = axios.CancelToken.source();\n\n  let warningTimer = setTimeout(() => {\n    if (retryFunction) {\n      retryFunction(cancel);\n    }\n    promptShown = true;\n  }, TIMER_DURATION);\n\n  let config;\n  // Checks if the call is being made in XDE or exp. (If XDE = XHR, if exp = HTTP);\n  if (!isNode()) {\n    config = {\n      timeout: TIMEOUT,\n      responseType: 'arraybuffer',\n      cancelToken: token,\n      onDownloadProgress: progressEvent => {\n        const roundedProgress = Math.floor(progressEvent.loaded / progressEvent.total * 100);\n        if (currentProgress !== roundedProgress) {\n          currentProgress = roundedProgress;\n          clearTimeout(warningTimer);\n          if (!promptShown) {\n            warningTimer = setTimeout(() => {\n              if (retryFunction) {\n                retryFunction(cancel);\n              }\n              promptShown = true;\n            }, TIMER_DURATION);\n          }\n        }\n        if (progressFunction) {\n          progressFunction(roundedProgress);\n        }\n      },\n    };\n    let response = await axios(url, config);\n    await fs.writeFile(outputPath, Buffer.from(response.data));\n    clearTimeout(warningTimer);\n  } else {\n    const tmpPath = `${outputPath}.download`;\n    config = {\n      timeout: TIMEOUT,\n      responseType: 'stream',\n      cancelToken: token,\n    };\n    let response = await axios(url, config);\n    await new Promise(resolve => {\n      let totalDownloadSize = response.data.headers['content-length'];\n      let downloadProgress = 0;\n      response.data\n        .on('data', chunk => {\n          downloadProgress += chunk.length;\n          const roundedProgress = Math.floor(downloadProgress / totalDownloadSize * 100);\n          if (currentProgress !== roundedProgress) {\n            currentProgress = roundedProgress;\n            clearTimeout(warningTimer);\n            if (!promptShown) {\n              warningTimer = setTimeout(() => {\n                if (retryFunction) {\n                  retryFunction(cancel);\n                }\n                promptShown = true;\n              }, TIMER_DURATION);\n            }\n            if (progressFunction) {\n              progressFunction(roundedProgress);\n            }\n          }\n        })\n        .on('end', () => {\n          clearTimeout(warningTimer);\n          if (progressFunction && currentProgress !== 100) {\n            progressFunction(100);\n          }\n          resolve();\n        })\n        .pipe(fs.createWriteStream(tmpPath));\n    });\n    await fs.rename(tmpPath, outputPath);\n  }\n}\n\nexport default class ApiClient {\n  static host: string = Config.api.host;\n  static port: number = Config.api.port || 80;\n\n  static _versionCache = new Cacher(\n    () => ApiClient.callPathAsync('/--/api/v2/versions'),\n    'versions.json',\n    0,\n    path.join(__dirname, '../caches/versions.json')\n  );\n\n  static _schemaCaches = {};\n\n  static async callMethodAsync(\n    methodName: string,\n    args: Array<*>,\n    method: string,\n    requestBody: ?Object,\n    requestOptions: ?Object = {},\n    returnEntireResponse: boolean = false\n  ): Promise<any> {\n    let url =\n      API_BASE_URL +\n      encodeURIComponent(methodName) +\n      '/' +\n      encodeURIComponent(JSON.stringify(args));\n    return _callMethodAsync(url, method, requestBody, requestOptions, returnEntireResponse);\n  }\n\n  static async callPathAsync(\n    path: string,\n    method: ?string,\n    requestBody: ?Object,\n    requestOptions: ?Object = {}\n  ) {\n    let url = ROOT_BASE_URL + path;\n    return _callMethodAsync(url, method, requestBody, requestOptions);\n  }\n\n  static async versionsAsync() {\n    return await ApiClient._versionCache.getAsync();\n  }\n\n  static async xdlSchemaAsync(sdkVersion) {\n    if (!ApiClient._schemaCaches.hasOwnProperty(sdkVersion)) {\n      ApiClient._schemaCaches[sdkVersion] = new Cacher(\n        async () => {\n          return await ApiClient.callPathAsync(`/--/xdl-schema/${sdkVersion}`);\n        },\n        `schema-${sdkVersion}.json`,\n        0,\n        path.join(__dirname, `../caches/schema-${sdkVersion}.json`)\n      );\n    }\n\n    return await ApiClient._schemaCaches[sdkVersion].getAsync();\n  }\n\n  static async sdkVersionsAsync() {\n    const { sdkVersions } = await ApiClient.versionsAsync();\n    return sdkVersions;\n  }\n\n  static async turtleSdkVersionsAsync() {\n    const { turtleSdkVersions } = await ApiClient.versionsAsync();\n    return turtleSdkVersions;\n  }\n\n  static async downloadAsync(url, outputPath, options = {}, progressFunction, retryFunction) {\n    if (options.extract) {\n      let dotExpoHomeDirectory = UserSettings.dotExpoHomeDirectory();\n      let tmpPath = path.join(dotExpoHomeDirectory, 'tmp-download-file');\n      await _downloadAsync(url, tmpPath);\n      await Extract.extractAsync(tmpPath, outputPath);\n      rimraf.sync(tmpPath);\n    } else {\n      await _downloadAsync(url, outputPath, progressFunction, retryFunction);\n    }\n  }\n}\n"],"sourceRoot":"/xdl@50.4.2/src"}